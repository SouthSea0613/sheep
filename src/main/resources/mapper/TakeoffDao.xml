<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com._401unauthorized.sheep.dao.TakeoffDao">
    <insert id="call">
        insert into apply_status values (#{user_id}, #{wish_number}, #{apply_status})
    </insert>

    <insert id="write">
        INSERT INTO WISH_CATEGORY_SELLER
        VALUES (#{user_id}, #{category_number}, #{wish_number}, #{wish_category_seller_answer}, #{wish_category_seller_price})
    </insert>

    <insert id="status">
        INSERT INTO APPLY_STATUS
        VALUES (#{user_id}, #{wish_number}, 0)
    </insert>

    <select id="get_category_detail" resultType="com._401unauthorized.sheep.dto.CategoryDto">
        SELECT MC.WISH_NUMBER, MC.CATEGORY_NUMBER AS CATEGORY_PARENT, C.CATEGORY_NUMBER, MC.MAJOR_TEXT
        FROM MAJOR_CATEGORY_CONTENT MC
        LEFT JOIN(
            SELECT C.CATEGORY_NUMBER, C.CATEGORY_PARENT, S.WISH_NUMBER
            FROM CATEGORY C
            JOIN SUB_CATEGORY S
            ON C.CATEGORY_NUMBER = S.CATEGORY_NUMBER) C
        ON C.CATEGORY_PARENT = MC.CATEGORY_NUMBER
        AND C.WISH_NUMBER = MC.WISH_NUMBER
        WHERE MC.WISH_NUMBER = #{wish_number}
    </select>
</mapper>