<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
	<meta charset="UTF-8">
	<title>Title</title>
	<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
	<script defer src="/javascript/common.js"></script>
	<link rel="stylesheet" href="/css/headerfooter.css">
	<link rel="stylesheet" href="/css/takeoff.css">
	<script>
		const user = "[[${session?.user_id}]]";
		const type = "[[${session?.user_type}]]";

		$(() => {
			console.log(type)
			userType();
			loginStatus();
		})
	</script>
	<script>
		onload=()=>{
			checkarea()
		}
		let num = 0;
		function writetab(){
			if(num===0){
			axios.post('/takeoff/seller/my_list',{
				user_id : "[[${session.user_id}]]"
			}).then((res)=>{
				console.log(res);
				if(res.data!=null){
					const enterlist = document.getElementById('enterlist')
					const content = document.getElementById('writetakeoff')
					enterlist.style.display = 'none';
					res.data.forEach(list=>{
						content.innerHTML+='<div class="entercontent">'+'<a href="/takeoff/seller/detail?wish_number='+list.wish_number+'&user_id='+list.user_id+ '">' + list.wish_title+'</a>'+'<span>'+list.apply_status+'</span>'+'</div>'
					})
					num=1;
				}
			})
			}
		}
		function entertab(){
			const enterlist = document.getElementById('enterlist')
			const content = document.getElementById('writetakeoff')
			enterlist.style.display ='block';
			content.textContent="";
			num=0;
		}
		function checkarea(){
			axios.post('/takeoff/checkarea',{
			}).then(res=>{
					const areadiv = document.getElementById('area')
				console.log(res.data)
					if(!res.data) {
						areadiv.style.display = "block";
					}
			})
		}
		function select_seller_area(){
			location.href = "/takeoff/seller/select_area"
		}
	</script>

</head>
<body>
<div class="area">
</div>
<th:block th:replace="~{common/fragment::header}"></th:block>
<h2>seller.list.html</h2>
<div>
	<th:block th:if="${#lists.isEmpty(seller_takeoff_list)}">
		<a th:href="@{takeoff/seller/location_insert}"></a>
	</th:block>
</div>
<div class="">
	<input type="button" class="" value="들어온 견적" onclick="entertab()">
	<input type="button" class="" value="작성한 견적" onclick="writetab()">
</div>
<div id="enterlist">
	<th:block th:if="${#lists.isEmpty(seller_takeoff_list)}">
		<div class="non_seller_takeoff_list">
			<div>들어온 견적리스트가 없습니다.</div>
			<input type="button" id="seller_area" onclick="select_seller_area()" value="지역설정">
		</div>
	</th:block>
	<th:block th:unless="${#lists.isEmpty(seller_takeoff_list)}">
		<th:block th:each="takeofflist : ${seller_takeoff_list}">
			<a th:href="@{/wish/detail(wish_number=${takeofflist.wish_number})}" th:text="${takeofflist.wish_title}"></a>
			<div th:text="${takeofflist.user_id}"></div>
		</th:block>
	</th:block>
</div>
<div id="writetakeoff">

</div>
<th:block th:replace="~{common/fragment::footer}"></th:block>
</body>
</html>