<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script th:inline="javascript">
        function wish_write() {
            location.href = "/wish/write"
        }

        function takeoff() {
            const wishnumber = document.querySelectorAll('.wish_number');

            console.log(wishnumber)
            axios.post('/takeoff/call',{
                user_id: '[[${session.user_id}]]',
                wish_number: wishnumber,
                apply_status: "0",
            }).then((res)=>{
                if(res){
                    alert("견적 요청이 완료되었습니다")
                    location.href="/wish/list";
                }else{
                    alert("견적 요청이 실패되었습니다");
                    location.href="/wish/list";
                }
            });
        }
    </script>
    <link rel="stylesheet" href="/css/index.css">
</head>
<body>
<th:block th:replace="~{common/fragment::header}"></th:block>
<h2>위시리스트 목록</h2>

<div class="list-area">
    <th:block th:if="${#lists.isEmpty(wish_list)}">
        <div>
            <div>위시리스트가 없습니다</div>
        </div>
    </th:block>
    <th:block th:unless="${#lists.isEmpty(wish_list)}">
        <th:block th:each="wish:${wish_list}">
            <div>
                <a th:href="@{/wish/detail(wish_number=${wish?.wish_number})}" th:text="${wish?.wish_title}"></a>
            </div>
            <div th:if="${wish?.apply_status}" th:text="${wish?.apply_status}">상태값</div>
            <div th:unless="${wish?.apply_status!=null}" class="takeoffarea">
                    <input type="hidden" th:value="${wish?.wish_number}" class="wish_number" name="wish_number">
                    <input type="button" id="wish_takeoff" onclick="takeoff()" value="견적요청">
            </div>
        </th:block>
    </th:block>
    <div class="wishBarea">
        <input type="button" id="wish_write" onclick="wish_write()" value="글쓰기">
    </div>
</div>
</body>
</html>